{% extends "base.html" %}
{% block title %}Change Password{% endblock %}
{% block content %}
<h1>Change Password</h1>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div style="padding: 10px; margin-bottom: 15px; border-radius: 5px; 
                  {% if category == 'error' %}background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
                  {% elif category == 'success' %}background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb;
                  {% endif %}">
        <strong>{{ category.title() }}:</strong> {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<!-- âœ… PART D: CSRF Protection -->
<form method="POST" novalidate>
  {{ form.hidden_tag() }}
  
  <p>
    {{ form.current_password.label }}<br>
    {{ form.current_password(size=32) }}
    {% for error in form.current_password.errors %}
      <span style="color: red;">{{ error }}</span><br>
    {% endfor %}
  </p>
  
  <p>
    {{ form.new_password.label }}<br>
    {{ form.new_password(size=32) }}
    {% for error in form.new_password.errors %}
      <span style="color: red;">{{ error }}</span><br>
    {% endfor %}
  </p>
  
  <p>{{ form.submit() }}</p>
</form>

<p><a href="{{ url_for('main.dashboard') }}">Back to Dashboard</a></p>
{% endblock %}